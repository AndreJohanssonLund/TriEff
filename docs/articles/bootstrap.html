<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bootstrap Analysis with trieff • trieff</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bootstrap Analysis with trieff"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">trieff</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/getting_started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/sim_te.html">Simulation in trieff</a></li>
    <li><a class="dropdown-item" href="../articles/calc_te.html">Calculating Triage Effectiveness</a></li>
    <li><a class="dropdown-item" href="../articles/bootstrap.html">Bootstrap Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/plot_te.html">Plotting Results</a></li>
    <li><a class="dropdown-item" href="../articles/heatmap.html">Heatmap Analysis</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-research" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Research</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-research"><li><a class="dropdown-item" href="../articles/original_study.html">Original Study (Under Review)</a></li>
    <li><a class="dropdown-item" href="../articles/publications.html">Publications Using trieff</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AndreJohanssonLund/trieff/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bootstrap Analysis with trieff</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AndreJohanssonLund/trieff/blob/HEAD/vignettes/bootstrap.Rmd" class="external-link"><code>vignettes/bootstrap.Rmd</code></a></small>
      <div class="d-none name"><code>bootstrap.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(trieff)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; Loaded trieff 1.0.0</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; System capable of parallel processing with multisession backend</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; Maximum available workers: 16</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; Note: Individual functions will determine optimal core usage at runtime</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;dplyr&#39;</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt;     filter, lag</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co"># Initialize data once at the start</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">init</span>(sem_malmo_synth) <span class="sc">%&gt;%</span> </span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  <span class="fu">sim_te</span>()</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Creating segments out of dataframe 2025-03-07 13:42:21.072217&quot;</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Filtered to 1486 segments with LOSET cases&quot;</span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Total LOSET cases: 5491&quot;</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Starting multisession with 1 cores. 2025-03-07 13:42:21.211775&quot;</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Simulations are done! 2025-03-07 13:42:25.644201&quot;</span></span></code></pre></div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Bootstrap analysis in trieff provides confidence intervals for Triage
Effectiveness metrics and enables assessment of statistical stability.
This vignette demonstrates how to use bootstrapping effectively and
interpret the results.</p>
<p>The confidence intervals calculated here can be visualized using the
plotting functions described in <code>vignette("plot_te")</code>. The
visualization provides an intuitive way to understand the uncertainty in
TE estimates.</p>
<p>Two bootstrapping methods are available in trieff:</p>
<ol style="list-style-type: decimal">
<li><strong>Standard Bootstrap</strong>: Traditional approach that
randomly samples individual cases with replacement.</li>
<li><strong>Segment Bootstrap</strong>: Advanced approach that preserves
temporal patterns by sampling segments of continuous queue
activity.</li>
</ol>
<p>Both methods work by repeatedly sampling from the dataset,
calculating TE metrics for each sample, and using the distribution of
these calculations to estimate confidence intervals.</p>
</div>
<div id="prerequisites" class="section level2">
<h2>Prerequisites</h2>
<ul>
<li>Knowledge on basic TE calculation (see
<code>vignette("calc_te")</code>)</li>
<li>Simulated theoretical wait times (see
<code>vignette("sim_te")</code>)</li>
</ul>
</div>
<div id="why-bootstrap" class="section level2">
<h2>Why Bootstrap?</h2>
<p>Bootstrapping helps us understand:</p>
<ul>
<li>The reliability of our TE metrics</li>
<li>The stability of our estimates</li>
<li>The impact of rare events and outliers</li>
</ul>
<p>For reliable bootstrap analysis, we recommend using at least 3 months
of ED data, though this guideline is based on preliminary analysis and
may need adjustment for your specific context.</p>
</div>
<div id="basic-bootstrap-usage" class="section level2">
<h2>Basic Bootstrap Usage</h2>
<p>Let’s start with a basic example using default bootstrap parameters.
We’ll use overall_only=TRUE to keep the output focused:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Calculate TE with bootstrap</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>te_results <span class="ot">&lt;-</span> <span class="fu">calc_te</span>(data, </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>                     <span class="at">bootstrap =</span> <span class="cn">TRUE</span>, </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>                     <span class="at">overall_only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Starting bootstrap iterations 2025-03-07 13:42:26.359226&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Bootstrap iterations done 2025-03-07 13:42:45.59851&quot;</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co"># View results</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="fu">print</span>(te_results)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; Triage Effectiveness Analysis Results</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; ===================================</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; Results for Overall </span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; ------------------- </span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; Total patients: 124311 (4.4% LOSET positive)</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; Classification Metrics:</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt;   Sensitivity: 73.7%</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt;   Specificity: 65.9%</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt; Triage Effectiveness Metrics:</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt;   OTE: 29.9%</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt;   TTE: 52.8%</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt;   OTG: -23.0%</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt; Bootstrap Variation Intervals:</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt;   OTE:  29.9% (26.8% to 32.9%) </span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt;   TTE:  52.8% (49.7% to 55.7%) </span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt;   OTG:  -23.0% (-26.4% to -19.4%) </span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co">#&gt; Computation Information</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="co">#&gt; =====================</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="co">#&gt; Method: Bootstrap calculation</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="co">#&gt; Number of iterations: 2000</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="co">#&gt; Sample percentage: 100%</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a><span class="co">#&gt; Distribution span: 95%</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a><span class="co">#&gt; Calculation time: 2025-03-07 13:42:45.616645</span></span></code></pre></div>
<p>The output now includes confidence intervals for each TE metric,
showing the uncertainty in our estimates.</p>
</div>
<div id="advanced-bootstrap-configuration" class="section level2">
<h2>Advanced Bootstrap Configuration</h2>
<p>The bootstrap process can be customized using several parameters:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Custom bootstrap settings</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>te_custom <span class="ot">&lt;-</span> <span class="fu">calc_te</span>(data,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                     <span class="at">bootstrap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                     <span class="at">overall_only =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                     <span class="at">seed =</span> <span class="dv">123</span>, <span class="co"># use seed to make your results reproducible</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                     <span class="at">bootstrap_params =</span> <span class="fu">list</span>(</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>                       <span class="at">sample_percentage =</span> <span class="fl">0.8</span>,  <span class="co"># Use 80% of data per iteration</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>                       <span class="at">n_iterations =</span> <span class="dv">1000</span>,      <span class="co"># decrease iterations</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>                       <span class="at">distribution_span =</span> <span class="fl">0.99</span>  <span class="co"># Wider confidence intervals</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>                     ))</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Starting bootstrap iterations 2025-03-07 13:42:46.005464&quot;</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Bootstrap iterations done 2025-03-07 13:42:56.326001&quot;</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="fu">print</span>(te_custom)</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt; Triage Effectiveness Analysis Results</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; ===================================</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt; Results for Overall </span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co">#&gt; ------------------- </span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co">#&gt; Total patients: 124311 (4.4% LOSET positive)</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt; Classification Metrics:</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#&gt;   Sensitivity: 73.7%</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co">#&gt;   Specificity: 65.9%</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="co">#&gt; Triage Effectiveness Metrics:</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co">#&gt;   OTE: 29.9%</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="co">#&gt;   TTE: 52.8%</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="co">#&gt;   OTG: -23.0%</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="co">#&gt; Bootstrap Variation Intervals:</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="co">#&gt;   OTE:  29.9% (25.2% to 34.6%) </span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="co">#&gt;   TTE:  52.8% (48.0% to 57.0%) </span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="co">#&gt;   OTG:  -23.0% (-28.2% to -17.9%) </span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a><span class="co">#&gt; Computation Information</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a><span class="co">#&gt; =====================</span></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="co">#&gt; Method: Bootstrap calculation</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a><span class="co">#&gt; Number of iterations: 1000</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="co">#&gt; Sample percentage: 80%</span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a><span class="co">#&gt; Distribution span: 99%</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a><span class="co">#&gt; Calculation time: 2025-03-07 13:42:56.338115</span></span></code></pre></div>
<p>Key parameters:</p>
<ul>
<li>sample_percentage: Controls resample size (default = 1)</li>
<li>n_iterations: Number of bootstrap iterations (default = 2000)</li>
<li>distribution_span: Width of confidence intervals (default =
0.95)</li>
</ul>
</div>
<div id="standard-vs.-segment-bootstrap" class="section level2">
<h2>Standard vs. Segment Bootstrap</h2>
<p>The trieff package offers two different bootstrapping methods:</p>
<div id="standard-bootstrap" class="section level3">
<h3>Standard Bootstrap</h3>
<p>The standard bootstrap method (<code>bootstrap = "standard"</code> or
simply <code>bootstrap = TRUE</code>) randomly samples individual
patient cases with replacement. This is the traditional bootstrap
approach.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Standard bootstrap</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>standard_bootstrap <span class="ot">&lt;-</span> <span class="fu">calc_te</span>(data,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                             <span class="at">bootstrap =</span> <span class="st">&quot;standard&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Starting bootstrap iterations 2025-03-07 13:42:56.726902&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Bootstrap iterations done 2025-03-07 13:43:16.047537&quot;</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">plot_te</span>(standard_bootstrap)</span></code></pre></div>
<p><img src="bootstrap_files/figure-html/standard-bootstrap-1.png" alt="Triage Effectiveness with confidence intervals calculated using standard bootstrap" width="960" /></p>
</div>
<div id="segment-bootstrap" class="section level3">
<h3>Segment Bootstrap</h3>
<p>The segment bootstrap method (<code>bootstrap = "segment"</code>)
preserves temporal patterns by sampling segments of continuous queue
activity. This approach maintains the dependency structure between
patients who were in the ED during the same time period.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Segment bootstrap</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>segment_bootstrap <span class="ot">&lt;-</span> <span class="fu">calc_te</span>(data,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                            <span class="at">bootstrap =</span> <span class="st">&quot;segment&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Creating segments for segment bootstrap 2025-03-07 13:43:16.525579&quot;</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Starting segment bootstrap with 9784 unit-segment pairs, 9784 samples per iteration, 2000 iterations 2025-03-07 13:43:17.999013&quot;</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Segment bootstrap iterations done 2025-03-07 13:43:29.407818&quot;</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">plot_te</span>(segment_bootstrap)</span></code></pre></div>
<p><img src="bootstrap_files/figure-html/segment-bootstrap-1.png" alt="Triage Effectiveness with confidence intervals calculated using segment bootstrap" width="960" /></p>
</div>
</div>
<div id="comparing-bootstrap-methods" class="section level2">
<h2>Comparing Bootstrap Methods</h2>
<p>While our theoretical understanding suggests segment bootstrapping
should be preferred for emergency department data, our empirical testing
has shown that both methods typically produce equivalent results in
practice with comparable confidence intervals amd neither consistently
producing wider or narrower intervals than the other. Despite
theoretical differences in how they handle data dependencies, their
practical outputs in terms of running means and confidence interval
convergence are remarkably similar. Both methods are maintained in the
package to support methodological research and to allow users to
validate results across different bootstrapping approaches, but for most
practical applications, the standard bootstrap provides an efficient and
reliable option.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Function to extract confidence intervals</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>get_ci_width <span class="ot">&lt;-</span> <span class="cf">function</span>(result) {</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  ci_width <span class="ot">&lt;-</span> result<span class="sc">$</span>results <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ote_ci_width =</span> boot_ote_var_upper <span class="sc">-</span> boot_ote_var_lower) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>    <span class="fu">select</span>(unit, ote_ci_width)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="fu">return</span>(ci_width)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>}</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co"># Compare CI widths</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>standard_ci <span class="ot">&lt;-</span> <span class="fu">get_ci_width</span>(standard_bootstrap)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>segment_ci <span class="ot">&lt;-</span> <span class="fu">get_ci_width</span>(segment_bootstrap)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> standard_ci <span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  <span class="fu">left_join</span>(segment_ci, <span class="at">by =</span> <span class="st">&quot;unit&quot;</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_standard&quot;</span>, <span class="st">&quot;_segment&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">difference =</span> ote_ci_width_segment <span class="sc">-</span> ote_ci_width_standard)</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="fu">print</span>(comparison)</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; [38;5;246m# A tibble: 4 × 4[39m</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt;   unit        ote_ci_width_standard ote_ci_width_segment difference</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt;   [3m[38;5;246m&lt;chr&gt;[39m[23m                       [3m[38;5;246m&lt;dbl&gt;[39m[23m                [3m[38;5;246m&lt;dbl&gt;[39m[23m      [3m[38;5;246m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt; [38;5;250m1[39m overall                    0.060[4m9[24m               0.068[4m0[24m   0.007[4m1[24m[4m2[24m </span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt; [38;5;250m2[39m medical                    0.065[4m9[24m               0.082[4m2[24m   0.016[4m3[24m  </span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt; [38;5;250m3[39m orthopedics                0.314                0.315    0.000[4m3[24m[4m9[24m[4m4[24m</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt; [38;5;250m4[39m surgical                   0.128                0.127   -[31m0[39m[31m.[39m[31m00[39m[31m1[4m0[24m[4m6[24m[39m</span></span></code></pre></div>
</div>
<div id="how-segment-bootstrap-works" class="section level2">
<h2>How Segment Bootstrap Works</h2>
<p>The segment bootstrap can be described by a custom block bootstrap
that operates by:</p>
<ol style="list-style-type: decimal">
<li>Identifying segments of continuous queue activity (periods where the
queue starts at 0 and ends at 0)</li>
<li>Sampling these segments with replacement</li>
<li>Calculating TE metrics for each resampled dataset</li>
</ol>
<p>This approach preserves the temporal structure of patient flow,
including:</p>
<ul>
<li><p>Arrival patterns</p></li>
<li><p>Concurrent cases</p></li>
<li><p>Crowding effects</p></li>
<li><p>Priority interrelationships</p></li>
</ul>
<p>While block bootstrapping reduces the effect of temporal effects, we
argue that this approach should remove this effect altogether. However,
keep in mind that this does not seem to affect the results, as stated
above.</p>
</div>
<div id="convergence-analysis" class="section level2">
<h2>Convergence Analysis</h2>
<p>Convergence analysis helps verify that our bootstrap estimates are
stable. When check_convergence=TRUE (which it is by standard), calc_te
generates three types of diagnostic plots:</p>
<ol style="list-style-type: decimal">
<li>Running Mean Plot
<ul>
<li>Shows how the average TE estimate evolves with more iterations</li>
<li>Should stabilize to a roughly horizontal line</li>
<li>Large fluctuations at the end suggest need for more iterations</li>
</ul></li>
<li>CI Width Plot
<ul>
<li>Shows how confidence interval width changes with iterations</li>
<li>Should decrease and stabilize</li>
<li>Continued narrowing suggests potential for more precise
estimates</li>
</ul></li>
<li>Standard Error Plot
<ul>
<li>Shows how the standard error of estimates changes</li>
<li>Should decrease and stabilize</li>
<li>Helps assess estimate precision</li>
</ul></li>
</ol>
<p>Let’s examine convergence for our analysis:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Calculate TE with convergence checking</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>te_convergence <span class="ot">&lt;-</span> <span class="fu">calc_te</span>(data,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                         <span class="at">bootstrap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                         <span class="at">overall_only =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                         <span class="at">check_convergence =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Starting bootstrap iterations 2025-03-07 13:43:30.265747&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Bootstrap iterations done 2025-03-07 13:43:49.749432&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co"># View convergence plots</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="fu">print</span>(te_convergence<span class="sc">$</span>convergence)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; Convergence Analysis Summary</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; =========================</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; Metrics analyzed: ote_te, tte_te, btte_te</span></span></code></pre></div>
<p><img src="bootstrap_files/figure-html/convergence-1.png" alt="Convergence plots for the bootstrap." width="960" /><img src="bootstrap_files/figure-html/convergence-2.png" alt="Convergence plots for the bootstrap." width="960" /></p>
<p>Interpreting convergence plots: - Look for stabilization in all three
metrics - Check if late iterations show systematic changes - Verify CI
width has reached reasonable stability</p>
<p>If convergence looks poor, consider: - Increasing n_iterations -
Checking for data quality issues - Verifying sufficient sample size</p>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>Bootstrap analysis in trieff provides valuable insights into the
reliability of TE metrics. Key points:</p>
<ol style="list-style-type: decimal">
<li>Use bootstrapping to get confidence intervals for TE metrics</li>
<li>Choose the appropriate bootstrap method:
<ul>
<li>Standard bootstrap for independent cases</li>
<li>Segment bootstrap for preserving temporal patterns</li>
</ul></li>
<li>Verify convergence using diagnostic plots</li>
<li>Adjust parameters based on dataset size and precision needs</li>
<li>Consider computational resources for large datasets</li>
</ol>
<p>Remember that while bootstrapping provides valuable statistical
information, it should be combined with domain knowledge and practical
considerations when evaluating triage system performance.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by André Johansson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>
