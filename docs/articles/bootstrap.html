<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bootstrap Analysis with trieff • trieff</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bootstrap Analysis with trieff">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">trieff</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting_started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/sim_te.html">Simulation in trieff</a></li>
    <li><a class="dropdown-item" href="../articles/calc_wte_rte.html">Calculating Triage Effectiveness</a></li>
    <li><a class="dropdown-item" href="../articles/bootstrap.html">Bootstrap Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/plot_te.html">Plotting Results</a></li>
    <li><a class="dropdown-item" href="../articles/heatmap.html">Heatmap Analysis</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-research" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Research</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-research">
<li><a class="dropdown-item" href="../articles/original_study.html">Original Study (Under Review)</a></li>
    <li><a class="dropdown-item" href="../articles/publications.html">Publications Using trieff</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AndreJohanssonLund/trieff/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bootstrap Analysis with trieff</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AndreJohanssonLund/trieff/blob/HEAD/vignettes/bootstrap.Rmd" class="external-link"><code>vignettes/bootstrap.Rmd</code></a></small>
      <div class="d-none name"><code>bootstrap.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://andrejohanssonlund.github.io/TriEff/index.html">trieff</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loaded trieff 1.2.0</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="co"># Initialize data once at the start</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_sem_synth.html">load_sem_synth</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/sim_te.html">sim_te</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Filtered to 1044 segments with LOSET cases"</span></span>
<span><span class="co">#&gt; [1] "Total LOSET cases: 3843"</span></span>
<span><span class="co">#&gt; [1] "Starting multisession with 1 cores. 2025-06-12 12:41:14.257479"</span></span>
<span><span class="co">#&gt; [1] "Simulations are done! 2025-06-12 12:41:17.228762"</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Bootstrap analysis in trieff provides confidence intervals for Triage
Effectiveness metrics and enables assessment of statistical stability.
This vignette demonstrates how to use bootstrapping effectively and
interpret the results.</p>
<p>The confidence intervals calculated here can be visualized using the
plotting functions described in <code><a href="../articles/plot_te.html">vignette("plot_te")</a></code>. The
visualization provides an intuitive way to understand the uncertainty in
TE estimates.</p>
<p>Two bootstrapping methods are available in trieff:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Standard Bootstrap</strong>: Traditional approach that
randomly samples individual cases with replacement.</li>
<li>
<strong>Segment Bootstrap</strong>: Advanced approach that preserves
temporal patterns by sampling segments of continuous queue
activity.</li>
</ol>
<p>Both methods work by repeatedly sampling from the dataset,
calculating TE metrics for each sample, and using the distribution of
these calculations to estimate confidence intervals.</p>
</div>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<ul>
<li>Knowledge on basic TE calculation (see
<code>vignette("calc_wte")</code>)</li>
<li>Simulated theoretical wait times (see
<code><a href="../articles/sim_te.html">vignette("sim_te")</a></code>)</li>
</ul>
</div>
<div class="section level2">
<h2 id="why-bootstrap">Why Bootstrap?<a class="anchor" aria-label="anchor" href="#why-bootstrap"></a>
</h2>
<p>Bootstrapping helps us understand:</p>
<ul>
<li>The reliability of our TE metrics</li>
<li>The stability of our estimates</li>
<li>The impact of rare events and outliers</li>
</ul>
<p>For reliable bootstrap analysis, we recommend using at least 3 months
of ED data, though this guideline is based on preliminary analysis and
may need adjustment for your specific context.</p>
</div>
<div class="section level2">
<h2 id="basic-bootstrap-usage">Basic Bootstrap Usage<a class="anchor" aria-label="anchor" href="#basic-bootstrap-usage"></a>
</h2>
<p>Let’s start with a basic example using default bootstrap parameters.
We’ll use overall_only=TRUE to keep the output focused:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate TE with bootstrap</span></span>
<span><span class="va">te_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_wte.html">calc_wte</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                     bootstrap <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                     overall_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Starting bootstrap iterations 2025-06-12 12:41:17.920562"</span></span>
<span><span class="co">#&gt; [1] "Bootstrap iterations done 2025-06-12 12:41:32.657718"</span></span>
<span></span>
<span><span class="co"># View results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">te_results</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Triage Effectiveness Analysis Results</span></span>
<span><span class="co">#&gt; ===================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results for Overall </span></span>
<span><span class="co">#&gt; ------------------- </span></span>
<span><span class="co">#&gt; Total patients: 53265 (7.2% LOSET positive)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Classification Metrics:</span></span>
<span><span class="co">#&gt;   Sensitivity: 64.3%</span></span>
<span><span class="co">#&gt;   Specificity: 73.3%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Triage Effectiveness Metrics:</span></span>
<span><span class="co">#&gt;   OTE: 36.3%</span></span>
<span><span class="co">#&gt;   TTE: 49.1%</span></span>
<span><span class="co">#&gt;   OTG: -12.8%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence Intervals (95%):</span></span>
<span><span class="co">#&gt;   OTE:  36.3% (32.7% to 39.9%) </span></span>
<span><span class="co">#&gt;   TTE:  49.1% (45.4% to 52.7%) </span></span>
<span><span class="co">#&gt;   OTG:  -12.8% (-17.1% to -8.4%) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computation Information</span></span>
<span><span class="co">#&gt; =====================</span></span>
<span><span class="co">#&gt; Method: Bootstrap calculation (waiting-time-based)</span></span>
<span><span class="co">#&gt; Number of iterations: 2000</span></span>
<span><span class="co">#&gt; Sample percentage: 100%</span></span>
<span><span class="co">#&gt; Distribution span: 95%</span></span>
<span><span class="co">#&gt; Confidence intervals: Boot method</span></span>
<span><span class="co">#&gt; Calculation time: 2025-06-12 12:41:32.974224</span></span></code></pre></div>
<p>The output now includes confidence intervals for each TE metric,
showing the uncertainty in our estimates.</p>
</div>
<div class="section level2">
<h2 id="advanced-bootstrap-configuration">Advanced Bootstrap Configuration<a class="anchor" aria-label="anchor" href="#advanced-bootstrap-configuration"></a>
</h2>
<p>The bootstrap process can be customized using several parameters:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Custom bootstrap settings</span></span>
<span><span class="va">te_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_wte.html">calc_wte</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                     bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     overall_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     seed <span class="op">=</span> <span class="fl">123</span>, <span class="co"># use seed to make your results reproducible</span></span>
<span>                     bootstrap_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                       sample_percentage <span class="op">=</span> <span class="fl">0.8</span>,  <span class="co"># Use 80% of data per iteration</span></span>
<span>                       n_iterations <span class="op">=</span> <span class="fl">1000</span>,      <span class="co"># decrease iterations</span></span>
<span>                       distribution_span <span class="op">=</span> <span class="fl">0.99</span>  <span class="co"># Wider confidence intervals</span></span>
<span>                     <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Starting bootstrap iterations 2025-06-12 12:41:33.344341"</span></span>
<span><span class="co">#&gt; [1] "Bootstrap iterations done 2025-06-12 12:41:45.202865"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">te_custom</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Triage Effectiveness Analysis Results</span></span>
<span><span class="co">#&gt; ===================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results for Overall </span></span>
<span><span class="co">#&gt; ------------------- </span></span>
<span><span class="co">#&gt; Total patients: 53265 (7.2% LOSET positive)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Classification Metrics:</span></span>
<span><span class="co">#&gt;   Sensitivity: 64.3%</span></span>
<span><span class="co">#&gt;   Specificity: 73.3%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Triage Effectiveness Metrics:</span></span>
<span><span class="co">#&gt;   OTE: 36.3%</span></span>
<span><span class="co">#&gt;   TTE: 49.1%</span></span>
<span><span class="co">#&gt;   OTG: -12.8%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence Intervals (95%):</span></span>
<span><span class="co">#&gt;   OTE:  36.3% (31.4% to 41.7%) </span></span>
<span><span class="co">#&gt;   TTE:  49.1% (43.3% to 54.5%) </span></span>
<span><span class="co">#&gt;   OTG:  -12.8% (-19.9% to -6.1%) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computation Information</span></span>
<span><span class="co">#&gt; =====================</span></span>
<span><span class="co">#&gt; Method: Bootstrap calculation (waiting-time-based)</span></span>
<span><span class="co">#&gt; Number of iterations: 1000</span></span>
<span><span class="co">#&gt; Sample percentage: 80%</span></span>
<span><span class="co">#&gt; Distribution span: 99%</span></span>
<span><span class="co">#&gt; Confidence intervals: Boot method</span></span>
<span><span class="co">#&gt; Calculation time: 2025-06-12 12:41:45.484291</span></span></code></pre></div>
<p>Key parameters:</p>
<ul>
<li>sample_percentage: Controls resample size (default = 1)</li>
<li>n_iterations: Number of bootstrap iterations (default = 2000)</li>
<li>distribution_span: Width of confidence intervals (default =
0.95)</li>
</ul>
</div>
<div class="section level2">
<h2 id="standard-vs--segment-bootstrap">Standard vs. Segment Bootstrap<a class="anchor" aria-label="anchor" href="#standard-vs--segment-bootstrap"></a>
</h2>
<p>The trieff package offers two different bootstrapping methods:</p>
<div class="section level3">
<h3 id="standard-bootstrap">Standard Bootstrap<a class="anchor" aria-label="anchor" href="#standard-bootstrap"></a>
</h3>
<p>The standard bootstrap method (<code>bootstrap = "standard"</code> or
simply <code>bootstrap = TRUE</code>) randomly samples individual
patient cases with replacement. This is the traditional bootstrap
approach.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Standard bootstrap</span></span>
<span><span class="va">standard_bootstrap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_wte.html">calc_wte</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                             bootstrap <span class="op">=</span> <span class="st">"standard"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Starting bootstrap iterations 2025-06-12 12:41:45.818225"</span></span>
<span><span class="co">#&gt; [1] "Bootstrap iterations done 2025-06-12 12:42:00.609282"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_te.html">plot_te</a></span><span class="op">(</span><span class="va">standard_bootstrap</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap_files/figure-html/standard-bootstrap-1.png" alt="Triage Effectiveness with confidence intervals calculated using standard bootstrap" width="960"></p>
</div>
<div class="section level3">
<h3 id="segment-bootstrap">Segment Bootstrap<a class="anchor" aria-label="anchor" href="#segment-bootstrap"></a>
</h3>
<p>The segment bootstrap method (<code>bootstrap = "segment"</code>)
preserves temporal patterns by sampling segments of continuous queue
activity. This approach maintains the dependency structure between
patients who were in the ED during the same time period.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Segment bootstrap</span></span>
<span><span class="va">segment_bootstrap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_wte.html">calc_wte</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                            bootstrap <span class="op">=</span> <span class="st">"segment"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Using existing segments for bootstrap 2025-06-12 12:42:01.276635"</span></span>
<span><span class="co">#&gt; [1] "Starting segment bootstrap with 3091 unit-segment pairs, 3091 samples per iteration, 2000 iterations 2025-06-12 12:42:01.277588"</span></span>
<span><span class="co">#&gt; [1] "Segment bootstrap iterations done 2025-06-12 12:42:20.555734"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_te.html">plot_te</a></span><span class="op">(</span><span class="va">segment_bootstrap</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap_files/figure-html/segment-bootstrap-1.png" alt="Triage Effectiveness with confidence intervals calculated using segment bootstrap" width="960"></p>
</div>
</div>
<div class="section level2">
<h2 id="comparing-bootstrap-methods">Comparing Bootstrap Methods<a class="anchor" aria-label="anchor" href="#comparing-bootstrap-methods"></a>
</h2>
<p>While our theoretical understanding suggests segment bootstrapping
should be preferred for emergency department data, our empirical testing
has shown that both methods typically produce equivalent results in
practice with comparable confidence intervals amd neither consistently
producing wider or narrower intervals than the other. Despite
theoretical differences in how they handle data dependencies, their
practical outputs in terms of running means and confidence interval
convergence are remarkably similar. Both methods are maintained in the
package to support methodological research and to allow users to
validate results across different bootstrapping approaches, but for most
practical applications, the standard bootstrap provides an efficient and
reliable option.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Function to extract confidence intervals</span></span>
<span><span class="va">get_ci_width</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ci_width</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ote_ci_width <span class="op">=</span> <span class="va">boot_ote_var_upper</span> <span class="op">-</span> <span class="va">boot_ote_var_lower</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">unit</span>, <span class="va">ote_ci_width</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">ci_width</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Compare CI widths</span></span>
<span><span class="va">standard_ci</span> <span class="op">&lt;-</span> <span class="fu">get_ci_width</span><span class="op">(</span><span class="va">standard_bootstrap</span><span class="op">)</span></span>
<span><span class="va">segment_ci</span> <span class="op">&lt;-</span> <span class="fu">get_ci_width</span><span class="op">(</span><span class="va">segment_bootstrap</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="va">standard_ci</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">segment_ci</span>, by <span class="op">=</span> <span class="st">"unit"</span>, suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_standard"</span>, <span class="st">"_segment"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>difference <span class="op">=</span> <span class="va">ote_ci_width_segment</span> <span class="op">-</span> <span class="va">ote_ci_width_standard</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;   unit    ote_ci_width_standard ote_ci_width_segment difference</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> overall                0.069<span style="text-decoration: underline;">9</span>               0.069<span style="text-decoration: underline;">6</span>  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">269</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C                      0.071<span style="text-decoration: underline;">5</span>               0.071<span style="text-decoration: underline;">2</span>  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">296</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> E                      0.139                0.130   -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">34</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-segment-bootstrap-works">How Segment Bootstrap Works<a class="anchor" aria-label="anchor" href="#how-segment-bootstrap-works"></a>
</h2>
<p>The segment bootstrap can be described by a custom block bootstrap
that operates by:</p>
<ol style="list-style-type: decimal">
<li>Identifying segments of continuous queue activity (periods where the
queue starts at 0 and ends at 0)</li>
<li>Sampling these segments with replacement</li>
<li>Calculating TE metrics for each resampled dataset</li>
</ol>
<p>This approach preserves the temporal structure of patient flow,
including:</p>
<ul>
<li><p>Arrival patterns</p></li>
<li><p>Concurrent cases</p></li>
<li><p>Crowding effects</p></li>
<li><p>Priority interrelationships</p></li>
</ul>
<p>While block bootstrapping reduces the effect of temporal effects, we
argue that this approach should remove this effect altogether. However,
keep in mind that this does not seem to affect the results, as stated
above.</p>
</div>
<div class="section level2">
<h2 id="convergence-analysis">Convergence Analysis<a class="anchor" aria-label="anchor" href="#convergence-analysis"></a>
</h2>
<p>Convergence analysis helps verify that our bootstrap estimates are
stable. When check_convergence=TRUE (which it is by standard), calc_wte
generates three types of diagnostic plots:</p>
<ol style="list-style-type: decimal">
<li>Running Mean Plot
<ul>
<li>Shows how the average TE estimate evolves with more iterations</li>
<li>Should stabilize to a roughly horizontal line</li>
<li>Large fluctuations at the end suggest need for more iterations</li>
</ul>
</li>
<li>CI Width Plot
<ul>
<li>Shows how confidence interval width changes with iterations</li>
<li>Should decrease and stabilize</li>
<li>Continued narrowing suggests potential for more precise
estimates</li>
</ul>
</li>
<li>Standard Error Plot
<ul>
<li>Shows how the standard error of estimates changes</li>
<li>Should decrease and stabilize</li>
<li>Helps assess estimate precision</li>
</ul>
</li>
</ol>
<p>Let’s examine convergence for our analysis:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate TE with convergence checking</span></span>
<span><span class="va">te_convergence</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_wte.html">calc_wte</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                         bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         overall_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         check_convergence <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Starting bootstrap iterations 2025-06-12 12:42:21.699323"</span></span>
<span><span class="co">#&gt; [1] "Bootstrap iterations done 2025-06-12 12:42:37.25343"</span></span>
<span></span>
<span><span class="co"># View convergence plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">te_convergence</span><span class="op">$</span><span class="va">convergence</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Convergence Analysis Summary</span></span>
<span><span class="co">#&gt; =========================</span></span>
<span><span class="co">#&gt; Metrics analyzed: ote_te, tte_te, btte_te</span></span></code></pre></div>
<p><img src="bootstrap_files/figure-html/convergence-1.png" alt="Convergence plots for the bootstrap." width="960"><img src="bootstrap_files/figure-html/convergence-2.png" alt="Convergence plots for the bootstrap." width="960"></p>
<p>Interpreting convergence plots: - Look for stabilization in all three
metrics - Check if late iterations show systematic changes - Verify CI
width has reached reasonable stability</p>
<p>If convergence looks poor, consider: - Increasing n_iterations -
Checking for data quality issues - Verifying sufficient sample size</p>
</div>
<div class="section level2">
<h2 id="comparing-confidence-intervals-for-rte">Comparing Confidence Intervals for RTE<a class="anchor" aria-label="anchor" href="#comparing-confidence-intervals-for-rte"></a>
</h2>
<p>While RTE CAN use direct calculation to show confidence intervals,
bootstrapping offers the best balance of validity and usable results in
our experience. Let’s examine the different approaches:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Calculate RTE with bootstrap</span></span>
<span><span class="va">rte_bootstrap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rte.html">calc_rte</a></span><span class="op">(</span><span class="va">data</span>, bootstrap <span class="op">=</span> <span class="cn">TRUE</span>, overall_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Processing 2 units with LOSET cases in parallel 2025-06-12 12:42:38.455676"</span></span>
<span><span class="co">#&gt; [1] "Processing unit: C 2025-06-12 12:42:39.355878"</span></span>
<span><span class="co">#&gt; [1] "Processing unit: E 2025-06-12 12:42:40.283046"</span></span>
<span><span class="co">#&gt; [1] "Starting RTE bootstrap with 2000 iterations, sample size 3529 from 3529 valid time-critical patients at 2025-06-12 12:42:41.083263"</span></span>
<span><span class="co">#&gt; [1] "RTE bootstrap completed at 2025-06-12 12:42:59.705387"</span></span>
<span></span>
<span><span class="co"># Calculate RTE with direct calculation (no bootstrap)</span></span>
<span><span class="va">rte_direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rte.html">calc_rte</a></span><span class="op">(</span><span class="va">data</span>, bootstrap <span class="op">=</span> <span class="cn">FALSE</span>, overall_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Processing 2 units with LOSET cases in parallel 2025-06-12 12:43:00.708675"</span></span>
<span><span class="co">#&gt; [1] "Processing unit: C 2025-06-12 12:43:01.681776"</span></span>
<span><span class="co">#&gt; [1] "Processing unit: E 2025-06-12 12:43:02.693575"</span></span>
<span></span>
<span><span class="co"># Create plots with different CI approaches</span></span>
<span><span class="va">plot_bootstrap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_te.html">plot_te</a></span><span class="op">(</span><span class="va">rte_bootstrap</span>, </span>
<span>                         title <span class="op">=</span> <span class="st">"RTE with Bootstrap CI"</span>,</span>
<span>                         min_x <span class="op">=</span> <span class="op">-</span><span class="fl">2.6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_parametric</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_te.html">plot_te</a></span><span class="op">(</span><span class="va">rte_direct</span>, </span>
<span>                          ci_vars_override <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>                          title <span class="op">=</span> <span class="st">"RTE with Parametric CI"</span>,</span>
<span>                          min_x <span class="op">=</span> <span class="op">-</span><span class="fl">2.6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_nonparametric</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_te.html">plot_te</a></span><span class="op">(</span><span class="va">rte_direct</span>, </span>
<span>                             ci_vars_override <span class="op">=</span> <span class="st">"nonparametric"</span>,</span>
<span>                             title <span class="op">=</span> <span class="st">"RTE with Non-parametric CI"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display plots</span></span>
<span><span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">plot_bootstrap</span>, <span class="va">plot_parametric</span>, <span class="va">plot_nonparametric</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrap_files/figure-html/rte-ci-comparison-1.png" alt="Comparison of different confidence interval approaches for RTE" width="960"></p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>Bootstrap analysis in trieff provides valuable insights into the
reliability of TE metrics. Key points:</p>
<ol style="list-style-type: decimal">
<li>Use bootstrapping to get confidence intervals for TE metrics</li>
<li>Choose the appropriate bootstrap method:
<ul>
<li>Standard bootstrap for independent cases</li>
<li>Segment bootstrap for preserving temporal patterns</li>
</ul>
</li>
<li>Verify convergence using diagnostic plots</li>
<li>Adjust parameters based on dataset size and precision needs</li>
<li>Consider computational resources for large datasets</li>
</ol>
<p>Remember that while bootstrapping provides valuable statistical
information, it should be combined with domain knowledge and practical
considerations when evaluating triage system performance.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by André Johansson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
