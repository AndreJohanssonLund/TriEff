% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim_te.R
\name{sim_te}
\alias{sim_te}
\title{Triage Efficacy Simulation}
\usage{
sim_te(df, tte = TRUE, btte = FALSE, n_workers = 1)
}
\arguments{
\item{df}{A data frame containing patient data, including (note that most of theese variables are created by init()):
\itemize{
\item id: Unique patient identifier
\item arrival_minute: Minutes since start of study period until patient arrival
\item resolve_minute: Minutes since start until patient sees physician
\item priority: Original triage priority
\item priority_binary: Binary priority (typically 1 for high, 2 for low)
\item loset: Logical indicating if patient is time-critical per LOSET criteria
\item observed_wait_time: Actual waiting time in minutes
}}

\item{tte}{Logical. If TRUE, calculates Theoretical Triage Efficacy (TTE). Default is TRUE.}

\item{btte}{Logical. If TRUE, calculates Binary Theoretical Triage Efficacy (BTTE). Default is FALSE.}

\item{n_workers}{Integer. Number of cores to use for parallel processing. Default is 1.}
}
\value{
A data frame with the original patient data and additional columns:
\itemize{
\item theoretical_wait_time: Simulated wait time based on original priorities (if tte=TRUE)
\item binary_theoretical_wait_time: Simulated wait time based on binary priorities (if btte=TRUE)
}
}
\description{
This function performs an optimized simulation to calculate Triage Efficacy (TE) metrics
by only simulating segments containing time-critical (LOSET-positive) cases. For segments
without LOSET cases, it uses observed wait times directly, since these segments don't
affect TE calculations. This optimization significantly reduces computation time while
maintaining identical TE results compared to the full simulation.
}
\details{
This function simulates how patients would be processed if strictly following their
assigned priority levels. The simulation operates by:
\enumerate{
\item Identifying continuous queue segments (periods where queue size goes from 0 to 0)
\item Determining which segments contain time-critical (LOSET) cases
\item Simulating only segments containing LOSET cases using a non-preemptive approach:
\itemize{
\item Each physician contact becomes an available time slot
\item Patients are queued by priority and arrival time
\item Wait times are calculated from slot assignment
}
\item For segments without LOSET cases, the observed wait times are retained as theoretical
wait times. This is valid because:
\itemize{
\item TE calculations depend only on LOSET patient wait times relative to mean_all
\item Using observed times for non-LOSET segments maintains the correct mean_all
\item The waiting times of non-LOSET patients do not affect TE calculations
}
}

The simulation ensures that:
\itemize{
\item Within each simulated segment, patients are seen strictly in order of priority
\item Within the same priority level, patients are seen in order of arrival
\item No post-triage priority changes occur
}
}
\examples{
\dontrun{
# Basic usage with default settings
results <- sim_te_fast(patient_data)

# Calculate both TTE and BTTE
results <- sim_te_fast(patient_data, tte = TRUE, btte = TRUE)
}

}
\seealso{
\code{\link{sim_te}} for the full simulation approach
}
