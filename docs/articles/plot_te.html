<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting Triage Effectiveness Results • trieff</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Plotting Triage Effectiveness Results">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trieff</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bootstrap.html">Bootstrap Analysis with trieff</a>
    </li>
    <li>
      <a href="../articles/calc_te.html">Calculating Triage Effectiveness</a>
    </li>
    <li>
      <a href="../articles/getting_started.html">Getting Started with trieff</a>
    </li>
    <li>
      <a href="../articles/heatmap.html">Heatmap Analysis in trieff</a>
    </li>
    <li>
      <a href="../articles/plot_te.html">Plotting Triage Effectiveness Results</a>
    </li>
    <li>
      <a href="../articles/sim_te.html">Simulation in trieff</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/yourusername/trieff/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Plotting Triage Effectiveness Results</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/yourusername/trieff/blob/HEAD/vignettes/plot_te.Rmd" class="external-link"><code>vignettes/plot_te.Rmd</code></a></small>
      <div class="hidden name"><code>plot_te.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yourusername/trieff" class="external-link">trieff</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loaded trieff 0.8.5</span></span>
<span><span class="co">#&gt; System capable of parallel processing with multisession backend</span></span>
<span><span class="co">#&gt; Maximum available workers: 16</span></span>
<span><span class="co">#&gt; Note: Individual functions will determine optimal core usage at runtime</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="co"># Initialize and simulate data once at the start</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span><span class="va">sem_malmo_synth</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/sim_te.html">sim_te</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Creating segments out of dataframe 2025-02-04 19:16:32.46484"</span></span>
<span><span class="co">#&gt; [1] "Initial segments: 9784 Total patients: 124311"</span></span>
<span><span class="co">#&gt; [1] "Filtered to 1486 segments with LOSET cases"</span></span>
<span><span class="co">#&gt; [1] "Total LOSET cases: 5491"</span></span>
<span><span class="co">#&gt; [1] "Creating batches 2025-02-04 19:16:37.963544"</span></span>
<span><span class="co">#&gt; [1] "Starting multisession with 1 cores. 2025-02-04 19:16:37.96989"</span></span>
<span><span class="co">#&gt; [1] "Simulations are done! 2025-02-04 19:16:42.776542"</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code><a href="../reference/plot_te.html">plot_te()</a></code> function provides flexible visualization
of Triage Effectiveness results. This vignette demonstrates how to
create and customize these visualizations, building on the analyses
shown in the calc_te and bootstrap vignettes.</p>
</div>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<ul>
<li>Calculated TE metrics (see <code><a href="../articles/calc_te.html">vignette("calc_te")</a></code>)</li>
<li>Optional: Bootstrap results for confidence intervals</li>
</ul>
</div>
<div class="section level2">
<h2 id="basic-plotting">Basic Plotting<a class="anchor" aria-label="anchor" href="#basic-plotting"></a>
</h2>
<p>Let’s start with a basic overall TE plot:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate TE metrics</span></span>
<span><span class="va">te_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_te.html">calc_te</a></span><span class="op">(</span><span class="va">data</span>, overall_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create basic plot</span></span>
<span><span class="fu"><a href="../reference/plot_te.html">plot_te</a></span><span class="op">(</span><span class="va">te_results</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_te_files/figure-html/basic-plot-1.png" alt="A simple Triage Effectiveness plot" width="672"></p>
<p>By default, the plot shows both Theoretical TE (teal) and Observed TE
(purple) values. The horizontal lines connecting these points represent
the Observed-Theoretical Gap (OTG).</p>
</div>
<div class="section level2">
<h2 id="plotting-bootstrap-results">Plotting Bootstrap Results<a class="anchor" aria-label="anchor" href="#plotting-bootstrap-results"></a>
</h2>
<p>The <code><a href="../reference/plot_te.html">plot_te()</a></code> function automatically handles bootstrap
results when they’re available. Let’s see how this changes the
visualization:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate TE with bootstrap</span></span>
<span><span class="va">te_bootstrap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_te.html">calc_te</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                       bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       overall_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Starting bootstrap iterations 2025-02-04 19:16:43.425424"</span></span>
<span><span class="co">#&gt; [1] "Bootstrap iterations done 2025-02-04 19:17:01.851786"</span></span>
<span></span>
<span><span class="co"># Plot with confidence intervals</span></span>
<span><span class="fu"><a href="../reference/plot_te.html">plot_te</a></span><span class="op">(</span><span class="va">te_bootstrap</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_te_files/figure-html/bootstrap-plot-1.png" alt="Triage Effectiveness plot with bootstrap" width="672"></p>
<p>Notice how the plot now includes variability intervals (lighter
shaded areas) for both TTE and OTE. These intervals are derived from the
bootstrap analysis and help visualize the uncertainty in our
estimates.</p>
</div>
<div class="section level2">
<h2 id="subgroup-analysis">Subgroup Analysis<a class="anchor" aria-label="anchor" href="#subgroup-analysis"></a>
</h2>
<p>We can visualize TE patterns across subgroups. Let’s use the age
group example from the calc_te vignette:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create age groups</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">age_at_arrival</span>, </span>
<span>                        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">59</span>, <span class="fl">79</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>                        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"18-59"</span>, <span class="st">"60-79"</span>, <span class="st">"80+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate and plot TE by age group</span></span>
<span><span class="va">te_age</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_te.html">calc_te</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                  var1 <span class="op">=</span> <span class="st">"age_group"</span>,</span>
<span>                  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  overall_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Starting bootstrap iterations 2025-02-04 19:17:02.372331"</span></span>
<span><span class="co">#&gt; [1] "Bootstrap iterations done 2025-02-04 19:17:21.704524"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_te.html">plot_te</a></span><span class="op">(</span><span class="va">te_age</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_te_files/figure-html/subgroup-plot-1.png" alt="Triage Effectiveness based on subgroups with bootstrapping" width="672"></p>
</div>
<div class="section level2">
<h2 id="handling-negative-te-values">Handling Negative TE Values<a class="anchor" aria-label="anchor" href="#handling-negative-te-values"></a>
</h2>
<p>In some cases, particularly when analyzing specific units, we might
encounter negative TE values. This requires special handling of the
plot’s x-axis. Let’s demonstrate this with two plots - one showing only
orthopedic units (which in the SEM synthpop has negative values) and
another showing all units:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, let's get results for orthopedic unit only</span></span>
<span><span class="va">ortho_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">unit</span> <span class="op">==</span> <span class="st">"orthopedics"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">te_ortho</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_te.html">calc_te</a></span><span class="op">(</span><span class="va">ortho_data</span>, bootstrap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Starting bootstrap iterations 2025-02-04 19:17:22.311197"</span></span>
<span><span class="co">#&gt; [1] "Bootstrap iterations done 2025-02-04 19:17:29.518354"</span></span>
<span></span>
<span><span class="va">data_other</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">unit</span> <span class="op">==</span> <span class="st">"orthopedics"</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Then get results for all units minus orthopedics</span></span>
<span><span class="va">te_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_te.html">calc_te</a></span><span class="op">(</span><span class="va">data_other</span>, bootstrap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Starting bootstrap iterations 2025-02-04 19:17:29.852901"</span></span>
<span><span class="co">#&gt; [1] "Bootstrap iterations done 2025-02-04 19:17:46.269091"</span></span>
<span></span>
<span><span class="co"># Plot orthopedic results</span></span>
<span><span class="fu"><a href="../reference/plot_te.html">plot_te</a></span><span class="op">(</span><span class="va">te_ortho</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_te_files/figure-html/negative-te-1-1.png" alt="A Triage Effectiveness plot that has negative values naturally" width="672"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plot all units with adjusted x-axis</span></span>
<span><span class="fu"><a href="../reference/plot_te.html">plot_te</a></span><span class="op">(</span><span class="va">te_all</span>, min_x <span class="op">=</span> <span class="op">-</span><span class="fl">0.4</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_te_files/figure-html/negative-te-2-1.png" alt="A Triage Effectiveness plot that has negative values forced" width="672"></p>
<p>Notice how setting <code>min_x = -0.3</code> ensures consistent scale
and alignment between the plots, making it easier to compare results
across different units.</p>
</div>
<div class="section level2">
<h2 id="advanced-plot-customization">Advanced Plot Customization<a class="anchor" aria-label="anchor" href="#advanced-plot-customization"></a>
</h2>
<p>While the default settings are suitable for most purposes,
<code><a href="../reference/plot_te.html">plot_te()</a></code> offers several customization options:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example with custom settings</span></span>
<span><span class="fu"><a href="../reference/plot_te.html">plot_te</a></span><span class="op">(</span><span class="va">te_bootstrap</span>,</span>
<span>        var_alpha <span class="op">=</span> <span class="fl">0.9</span>,          <span class="co"># less transparent variability intervals</span></span>
<span>        dumbell_width <span class="op">=</span> <span class="fl">1.5</span>,      <span class="co"># Thicker connecting lines</span></span>
<span>        label_style <span class="op">=</span> <span class="st">"small"</span>,    <span class="co"># small text labels</span></span>
<span>        title <span class="op">=</span> <span class="st">"Custom TE Plot"</span><span class="op">)</span> <span class="co"># Custom title</span></span></code></pre></div>
<p><img src="plot_te_files/figure-html/customization-1.png" alt="A Triage Effectiveness plot with custom arguments changing its appearance" width="672"></p>
<p>Key customization parameters include:</p>
<ul>
<li><p><code>var_alpha</code>: Controls transparency of variability
intervals (0-1)</p></li>
<li><p><code>dumbell_width</code>: Width of lines connecting TTE and OTE
points</p></li>
<li><p><code>label_style</code>: Can be “none”, “small”, “full”, or
“half” (default)</p></li>
<li><p><code>show_tte</code>/<code>show_ote</code>: Toggle display of
specific metrics</p></li>
<li><p><code>show_var</code>: Toggle display of variability
intervals</p></li>
</ul>
<p>For more details on available parameters, see
<code><a href="../reference/plot_te.html">?plot_te</a></code>.</p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette has demonstrated how to:</p>
<ol style="list-style-type: decimal">
<li><p>Create basic TE plots</p></li>
<li><p>Visualize bootstrap confidence intervals</p></li>
<li><p>Handle subgroup analyses</p></li>
<li><p>Deal with negative TE values</p></li>
<li><p>Customize plot appearance</p></li>
</ol>
<p>For more complex analyses, consider combining these visualization
techniques with the methods described in the calc_te and bootstrap
vignettes.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by André Johansson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
